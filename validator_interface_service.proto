syntax = "proto3";

import "packet.proto";
import "shared.proto";
import "bundle.proto";

package validator_interface;

message SubscribePacketsRequest {
  bool is_block_engine = 1;
}
message SubscribePacketsResponse {
  oneof msg {
    packet.PacketBatchList batch_list = 1;
    shared.Header heartbeat = 2;
  }
}

message GetTpuConfigsRequest {}
message GetTpuConfigsResponse {
  shared.Socket tpu = 1;
  shared.Socket tpu_forward = 2;
}


message SubscribeBundlesRequest {}
message SubscribeBundlesResponse {
  repeated bundle.Bundle bundles = 1;
}

service ValidatorInterface {
  // RPC endpoint to get the tpu `IP:PORT` to direct client traffic to from the validator.
  rpc GetTpuConfigs (GetTpuConfigsRequest) returns (GetTpuConfigsResponse) {}
  // RPC endpoint to subscribe to signature-verified packets.
  rpc SubscribePackets (SubscribePacketsRequest) returns (stream SubscribePacketsResponse) {}
  // RPC endpoint for the validator to subscribe to bundles
  rpc SubscribeBundles (SubscribeBundlesRequest) returns (stream SubscribeBundlesResponse) {}
}
